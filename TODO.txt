1. improve thresholding
3. empty rows in source mapping


Problematic test case:

